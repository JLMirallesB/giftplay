<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIFTPlay - Presentador</title>
    <link rel="stylesheet" href="assets/css/common.css">
    <link rel="stylesheet" href="assets/css/presentador.css">
    <!-- KaTeX para f√≥rmulas matem√°ticas -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
</head>
<body>
    <div id="app">
        <!-- Pantalla de Carga Inicial -->
        <div id="pantalla-inicio" class="pantalla active">
            <div class="container">
                <h1 class="logo">üéÆ GIFTPlay</h1>
                <p class="subtitle" data-i18n-key="presenter_subtitle">Cuestionarios interactivos en tiempo real</p>

                <div class="upload-section">
                    <!-- Toggle entre Subir Archivo y Pegar Texto -->
                    <div class="input-mode-toggle">
                        <button id="btn-mode-file" class="toggle-btn active" data-i18n-key="mode_upload_file">üìÅ Subir Archivo</button>
                        <button id="btn-mode-text" class="toggle-btn" data-i18n-key="mode_paste_text">üìã Pegar Texto</button>
                    </div>

                    <!-- Secci√≥n de subir archivo -->
                    <div id="file-upload-section" class="input-section">
                        <label for="gift-file-input" class="file-label">
                            <span data-i18n-key="upload_gift_file">üìÅ Subir archivo GIFT</span>
                            <input type="file" id="gift-file-input" accept=".gift,.txt" hidden>
                        </label>
                    </div>

                    <!-- Secci√≥n de pegar texto -->
                    <div id="text-input-section" class="input-section hidden">
                        <textarea
                            id="gift-text-input"
                            class="gift-textarea"
                            data-i18n-key="paste_gift_here"
                            placeholder="Pega aqu√≠ tu texto en formato GIFT..."
                            rows="10"
                        ></textarea>
                        <button id="btn-process-text" class="btn btn-primary" data-i18n-key="process_text">Procesar Texto</button>
                    </div>

                    <!-- Info del archivo/texto procesado -->
                    <div id="file-info" class="file-info hidden">
                        <span id="file-name"></span>
                        <span id="file-questions"></span>
                    </div>

                    <!-- Visualizador de preguntas -->
                    <div id="questions-preview" class="questions-preview hidden">
                        <div class="preview-header">
                            <h3 data-i18n-key="questions_preview">Vista previa de preguntas</h3>
                            <button id="btn-toggle-preview" class="btn-icon" data-i18n-key="collapse">‚ñ≤</button>
                        </div>
                        <div id="questions-list" class="questions-list"></div>
                    </div>
                </div>

                <div class="config-section">
                    <label for="tiempo-pregunta" data-i18n-key="time_per_question">‚è±Ô∏è Tiempo por pregunta (segundos):</label>
                    <select id="tiempo-pregunta">
                        <option value="20">20 segundos</option>
                        <option value="30" selected>30 segundos</option>
                        <option value="60">60 segundos</option>
                        <option value="90">90 segundos</option>
                        <option value="120">120 segundos</option>
                        <option value="180">180 segundos</option>
                    </select>
                </div>

                <button id="btn-empezar-sesion" class="btn btn-primary" disabled data-i18n-key="start_session">Empezar Sesi√≥n</button>

                <div id="error-message" class="error-message hidden"></div>
            </div>

            <!-- Selector de idioma -->
            <div class="language-selector">
                <div id="lang-selector"></div>
            </div>
        </div>

        <!-- Pantalla de Lobby -->
        <div id="pantalla-lobby" class="pantalla">
            <div class="container">
                <h2 data-i18n-key="waiting_for_players">Esperando jugadores...</h2>

                <div class="session-info">
                    <div class="game-code">
                        <span data-i18n-key="game_code">C√≥digo de la partida:</span>
                        <span id="codigo-partida" class="code"></span>
                    </div>

                    <div class="qr-container">
                        <div id="qr-code"></div>
                    </div>

                    <div class="url-container">
                        <input type="text" id="url-partida" readonly>
                        <button id="btn-copiar-url" class="btn btn-secondary" data-i18n-key="copy_url">Copiar URL</button>
                    </div>
                </div>

                <div class="players-section">
                    <h3><span data-i18n-key="connected_players">Jugadores conectados:</span> <span id="player-count">0</span></h3>
                    <div id="players-list" class="players-grid"></div>
                </div>

                <button id="btn-empezar-juego" class="btn btn-primary" disabled data-i18n-key="start_game">Empezar Juego</button>
            </div>
        </div>

        <!-- Pantalla de Pregunta -->
        <div id="pantalla-pregunta" class="pantalla">
            <div class="container">
                <div class="question-header">
                    <div class="question-number">
                        <span data-i18n-key="question">Pregunta</span> <span id="num-pregunta-actual">1</span> / <span id="num-pregunta-total">10</span>
                    </div>
                    <div class="timer">
                        <span id="tiempo-restante">30</span>s
                    </div>
                </div>

                <div id="multimedia-container" class="multimedia-container hidden"></div>

                <div class="question-text" id="texto-pregunta"></div>

                <div class="answers-grid" id="respuestas-grid"></div>

                <div class="controls">
                    <button id="btn-pausar" class="btn btn-secondary" data-i18n-key="pause">Pausar</button>
                    <button id="btn-finalizar-pregunta" class="btn btn-primary" data-i18n-key="end_question">Finalizar Pregunta</button>
                </div>

                <div class="player-responses">
                    <h4 data-i18n-key="responses_received">Respuestas recibidas:</h4>
                    <div id="responses-count">0 / <span id="total-players">0</span></div>
                    <div id="responses-list" class="responses-grid"></div>
                </div>
            </div>
        </div>

        <!-- Pantalla de Resultados de Pregunta -->
        <div id="pantalla-resultado-pregunta" class="pantalla">
            <div class="container">
                <h2 data-i18n-key="question_results">Resultados de la Pregunta</h2>

                <div class="correct-answer-section">
                    <h3 data-i18n-key="correct_answer">Respuesta(s) correcta(s):</h3>
                    <div id="respuesta-correcta-display"></div>
                </div>

                <div class="statistics">
                    <div class="stat-card">
                        <div class="stat-value" id="stat-correct">0</div>
                        <div class="stat-label" data-i18n-key="correct_answers">Respuestas correctas</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-incorrect">0</div>
                        <div class="stat-label" data-i18n-key="incorrect_answers">Respuestas incorrectas</div>
                    </div>
                </div>

                <div class="leaderboard">
                    <h3 data-i18n-key="leaderboard">Clasificaci√≥n</h3>
                    <div id="leaderboard-list"></div>
                </div>

                <button id="btn-siguiente-pregunta" class="btn btn-primary" data-i18n-key="next_question">Siguiente Pregunta</button>
            </div>
        </div>

        <!-- Pantalla de Resultados Finales -->
        <div id="pantalla-resultados-finales" class="pantalla">
            <div class="container">
                <h1 data-i18n-key="final_results">üèÜ Resultados Finales</h1>

                <div class="podium">
                    <div id="podium-container"></div>
                </div>

                <div class="final-leaderboard">
                    <div id="final-leaderboard-list"></div>
                </div>

                <div class="actions">
                    <button id="btn-nueva-partida" class="btn btn-primary" data-i18n-key="new_game">Nueva Partida</button>
                    <button id="btn-exportar-resultados" class="btn btn-secondary" data-i18n-key="export_results">Exportar Resultados</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts externos -->
    <script src="https://unpkg.com/peerjs@1.5.5/dist/peerjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>

    <!-- Scripts de la aplicaci√≥n -->
    <script src="src/shared/i18n.js"></script>
    <script src="src/shared/protocol.js"></script>
    <script src="src/lib/gift/parser.js"></script>
    <script src="src/presentador/peer-manager.js"></script>
    <script src="src/presentador/game-state.js"></script>
    <script src="src/presentador/app.js"></script>
</body>
</html>
